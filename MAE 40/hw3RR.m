% Problem 1 solved by hand on pdf
% Problem 2
syms Ra Rb Cc Cd Vin s K;
A=[0 0 1 -1 0 -1 0; 0 0 0 1 -1 1 -1; K 1 0 0 0 0 0; 1 0 0 Ra 0 0 0; ...
   Cc*s 0 0 0 0 1 0; 1 -1 0 0 -Rb 0 0; Cd*s -Cd*s 0 0 0 0 -1];
b=[0; 0; 0; Vin; Cc*s*Vin; 0; 0]; x=A\b; 
func = x(2) / Vin;

% Problem 3a
syms r R M1 M2 M3 ma mb mc V1 V2 V3 va vb vc f;
A=[1 -1 0 0 0 0 0 0 0 0 0; 0 1 0 0 0 R/M1 0 0 0 0 0; 0 1 0 0 0 0 R/M2 0 0 0 0; ...
   0 1 0 0 0 0 0 R/M3 0 0 0; 0 1 -1 0 -R 0 0 0 0 0 0; 0 0 0 0 -1 1 1 1 0 0 0; ...
   1 0 0 0 0 0 0 0 r/ma 0 0; 1 0 0 0 0 0 0 0 0 r/mb 0; 1 0 0 0 0 0 0 0 0 0 r/mc;...
   1 0 0 -r/f 0 0 0 0 0 0 0; 0 0 0 -1 0 0 0 0 1 1 1];
b=[0; V1; V2; V3; 0; 0; va; vb; vc; 0; 0]; x=A\b; 
func = x(3);

% Problem 3b
syms r R M1 M2 M3 ma mb mc V1 V2 V3 va vb vc f;
A=[1 -1 0 0 0 0 0 0 0 0 0; 0 1 0 0 0 R/M1 0 0 0 0 0; 0 1 0 0 0 0 R/M2 0 0 0 0; ...
   0 1 0 0 0 0 0 R/M3 0 0 0; 0 1 -1 0 -R 0 0 0 0 0 0; 0 0 0 -1 -1 1 1 1 0 0 0; ...
   1 0 0 0 0 0 0 0 r/ma 0 0; 1 0 0 0 0 0 0 0 0 r/mb 0; 1 0 0 0 0 0 0 0 0 0 r/mc;...
   1 0 0 -R/f 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 1 1 1];
b=[0; V1; V2; V3; 0; 0; va; vb; vc; 0; 0]; x=A\b; 
func = x(3); 

% Problem 4
syms R C s Vin;
A=[0 0 0 0 0 1 -1 0 0 -1 0 0; 0 0 0 0 0 0 0 0 0 1 -1 -1; 0 0 0 0 0 0 1 -1 -1 0 0 0; ...
   0 0 -1 0 1 0 0 0 0 0 0 -R/2; 1 -1 0 0 0 0 0 0 0 0 0 0; 0 0 0 1 0 0 R 0 0 0 0 0; ...
   0 0 0 -2*C*s 0 0 0 0 1 0 0 0; 0 -1 1 0 0 0 0 0 0 0 0 -R; 0 -1 0 0 0 0 0 0 0 0 0 R;...
   -1 0 0 1 0 0 0 -R 0 0 0 0; C*s 0 0 0 -C*s 0 0 0 0 0 1 0; 0 0 0 0 C*s 0 0 0 0 1 0 0];
b=[0; 0; 0; 0; 0; Vin; 0; 0; 0; 0; 0; Vin*C*s]; x=A\b; 
func = x(3) / Vin;